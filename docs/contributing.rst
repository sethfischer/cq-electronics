============
Contributing
============

Development environment
-----------------------

#. Clone and install cq-electronics.

    a. Clone and install:

        .. code:: text

            git clone https://github.com/sethfischer/cq-electronics.git
            cd cq-electronics
            python3.9 -m venv .venv
            . .venv/bin/activate
            pip install -U pip
            poetry install

    b. Install Git hooks:

        .. code:: text

            make install-git-hooks

#. Create a new project with cq-electronics installed in develop mode.

    a. Create new project:

        .. code:: text

            mkdir cq-electronics-dev
            cd cq-electronics-dev
            python3.9 -m venv .venv
            . .venv/bin/activate
            pip install -U pip
            poetry init

        In ``pyproject.toml`` specify relative path to cq-electronics:

        .. code:: toml

            [tool.poetry]
            name = "cq-electronics-dev"
            version = "0.1.0"
            description = "Development project for cq-electronics"
            authors = ["name <email>"]

            [tool.poetry.dependencies]
            python = ">=3.9,<3.11"
            cq-electronics = { path = "../cq-electronics", develop = true }

            [tool.poetry.group.dev.dependencies]
            cq-editor = { git = "https://github.com/CadQuery/CQ-editor" }
            Logbook = "^1.5.3"
            PyQt5 = "^5.15.6"
            path = "^16.4.0"
            pyqtgraph = "^0.12.4"
            requests = "^2.27.1"
            spyder = "~=5.0"

            [build-system]
            requires = ["poetry-core>=1.0.0"]
            build-backend = "poetry.core.masonry.api"

    b. Install dependencies, including ``../cq-electronics``:

        .. code:: text

            poetry install

    c. Copy examples from the ``examples`` directory and open with CQ-editor:

        .. code:: text

            cp ../cq-electronics/examples/*.py ./
            cq-editor raspberry_pi_3b.py

Documentation
-------------

.. note::

    To render the three.js visualisations generated by `sphinxcadquery`_
    the documentation must be served by a local server such as `sphinx-serve`_.

Build the documentation:

.. code:: text

    make -C docs/ clean html


.. _`sphinxcadquery`: https://pypi.org/project/sphinxcadquery/
.. _`sphinx-serve`: https://pypi.org/project/sphinx-serve/
